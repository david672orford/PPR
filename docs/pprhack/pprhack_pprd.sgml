<sect1>
<title>Protocol for Comunicating with <command>pprd</command></title>

<para>
This section describes the protocol which use commands such as <command>ppr</command>,
<command>ppop</command>, and <command>ppad</command> use to communicate with <command>pprd</command> and <command>rpprd</command>.
This information may assist those attempting to understand the source code.
</para>

<para>
The main printing daemon, <command>pprd</command> receives commands over a named pipe and
acts on them.  The program <command>ppr</command> uses one such command it sends to <command>pprd</command>
to tell it that a new jobs has been placed in the queue directories.  The
program <command>ppad</command> has two such commands which it uses to inform <command>pprd</command> that
a printer or group configuration file has been modified.  Finally, <command>ppop</command>
has many commands which it uses to control <command>pprd</command> or to request information
from it.
</para>

<sect2>
<title>Accepting Jobs</title>

<para>
Once the job submission program <command>ppr</command> has created the queue files it
sends a command to <command>pprd</command> or <command>rpprd</command> telling it that the job is there and
is ready for printing or transfer to the remote system.  This command takes the
form:
</para>

<para>
j <replaceable>destination_node destination_queue id subid home_node initial_priority</replaceable>
</para>

<para>
The <replaceable>destination_node</replaceable> is the node to which the job should be sent.  If the
command is written to <command>pprd</command>'s named pipe, this field must contain the node
name of the local system.  The <replaceable>destination_queue</replaceable> is the name of the print
queue on the destination node.  The <replaceable>id</replaceable> and <replaceable>subid</replaceable> are the queue id and
the job fragment number respectively.  The <replaceable>subid</replaceable> will most often be zero.
The <replaceable>home_node</replaceable> is the node name of the system on which the job origionated.
</para>

</sect2>

<sect2>
<title>Re-loading Configuration Files</title>

<para>
Whenever a printer or group configuration files is modified or a new one
created, <command>pprd</command> must be directed to read it.  To inform <command>pprd</command> that it
must read a new or revised printer configuration file, a command line of this
form is sent:
</para>

<para>

<screen>
NP <replaceable>printername</replaceable>
</screen>

</para>

<para>
To indicate that a group configuration file
must be re-read or that a new group configuration file must be read for the
first time:
</para>

<para>

<screen>
NG <replaceable>groupname</replaceable>
</screen>

</para>

<para>
There will be no acknowledgement of either command.
</para>

</sect2>

<sect2>
<title>Yielding Information to <command>ppop</command></title>

<para>
The utility <command>ppop</command> must communicate with <command>pprd</command> and <command>rpprd</command> in
order to list the queue, show the status of printers, mount forms, and do other
tasks.  As work on <command>rpprd</command> continue, descriptions of the necessary commands
will be added to this document.
</para>

</sect2>

</sect1>
